
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lecture11/">
      
      
        <link rel="next" href="../lecture13/">
      
      
      <link rel="icon" href="../img/dragon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.36">
    
    
      
        <title>Visualizing and Understanding - Autonomier's Notes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.06209087.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Merriweather";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lecture-12-visualizing-and-understanding" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Autonomier&#39;s Notes" class="md-header__button md-logo" aria-label="Autonomier's Notes" data-md-component="logo">
      
  <img src="../img/dragon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Autonomier's Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Visualizing and Understanding
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../CS231n/" class="md-tabs__link">
          
  
  CS231n

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../papers/3DGS/" class="md-tabs__link">
          
  
  Papers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Games101/games101/" class="md-tabs__link">
          
  
  Games101

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Autonomier&#39;s Notes" class="md-nav__button md-logo" aria-label="Autonomier's Notes" data-md-component="logo">
      
  <img src="../img/dragon.png" alt="logo">

    </a>
    Autonomier's Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CS231n
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            CS231n
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CS231n/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Classification with Linear Classifiers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loss Functions and Optimization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backpropagation and Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignment1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assignment 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convolutional Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Neural Networks, Part 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Neural Networks, Part 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep Learning Software
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CNN Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignment2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assignment 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recurrent Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detection and Segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Visualizing and Understanding
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Visualizing and Understanding
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#visualizing-filters" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing Filters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualizing Filters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#first-layer" class="md-nav__link">
    <span class="md-ellipsis">
      First Layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Other Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#last-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Last Layer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Last Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nearest-neighbour" class="md-nav__link">
    <span class="md-ellipsis">
      Nearest Neighbour
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dinmensionality-reduction" class="md-nav__link">
    <span class="md-ellipsis">
      Dinmensionality Reduction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualizing-activations" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing Activations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualizing Activations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maximally-activating-patches" class="md-nav__link">
    <span class="md-ellipsis">
      Maximally Activating Patches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#occlusion-experiments" class="md-nav__link">
    <span class="md-ellipsis">
      Occlusion Experiments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saliency-map" class="md-nav__link">
    <span class="md-ellipsis">
      Saliency Map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imtermediate-features-via-guided-backprop" class="md-nav__link">
    <span class="md-ellipsis">
      Imtermediate Features via (guided) backprop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualizing-cnn-features-gradient-ascent" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing CNN Features: Gradient Ascent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deep-dream-amplify-existing-features" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Dream: Amplify existing features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feature-inversion" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Inversion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#texture-synthesis" class="md-nav__link">
    <span class="md-ellipsis">
      Texture synthesis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neural-style-transfer" class="md-nav__link">
    <span class="md-ellipsis">
      Neural Style Transfer
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generative Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignment3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assignment 3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Papers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Papers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../papers/3DGS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3D Gaussian Splatting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Games101
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Games101
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Games101/games101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Games101/lecture2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Review of Linear Algebra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Games101/lecture3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Games101/lecture5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rasterization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Games101/lecture7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shading
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Games101/pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphics Pipeline
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="lecture-12-visualizing-and-understanding">Lecture 12: Visualizing and Understanding</h1>
<blockquote>
<p>An neural network, especially a convolutional neural network, is just like a blackbox to us, where we input an image and get some results. But how does it actually work, what's all those intermediare feature looking for? These questions are what we are going to answer in this lecture.</p>
</blockquote>
<h2 id="visualizing-filters">Visualizing Filters</h2>
<h3 id="first-layer">First Layer</h3>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%281%29.png" width="600px" /></p>
<p>可以看到第一层卷积核往往是在寻找一些较为简单的特征, 比如一些edge, blob之类.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>为什么卷积核长什么样子代表了他寻找什么样的特征?
<br>卷积核与我们的图像进行的是点积操作, 在二者相同的情况下响应值最大.</p>
</div>
<h3 id="other-layers">Other Layers</h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>我们也可以可视化一下除了first layer之外的其他layer, 但是由于这些layer作用的对象并不是图像本身, 而是经过一些filter处理的activation map, 所以他们的可视化结果并不是很直观.</p>
</div>
<h3 id="last-layer">Last Layer</h3>
<p>Suppose our last layer is mapping a 4096 feature vector to 10 categories. We run the network on many images, then collect the feature vectors for all these images.</p>
<h4 id="nearest-neighbour">Nearest Neighbour</h4>
<p>For each of the image, we take its fearure vector, and find the nearest neighbour of its feature vactor produced by other images, then compare these images. The results are as follows:</p>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%282%29.png" width="300px" /></p>
<blockquote>
<p>不同于直接对图像求nearest neighbour, 我们对特征向量求nearest neighbour, 可以大大增加图像匹配的准确率, 比如第二行中一只头朝左的大象可以成功匹配到一只头朝右的大象, 这说明只要是大象这一类, 提取出来的feature vector都很相近.</p>
</blockquote>
<h4 id="dinmensionality-reduction">Dinmensionality Reduction</h4>
<p>Visualize the "space" of feature vectos by reducing dimensionality of vectors from 4096 to 2 dimensions.</p>
<p>Algorithms: Principle Component Analysis(PCA), t-SNE...</p>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%283%29.png" width="300px" /></p>
<blockquote>
<p>可以看到有明显的聚类效果, 不同的类别被分成了一个个cluster.</p>
</blockquote>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%284%29.png" width="600px" /></p>
<blockquote>
<p>可以看到, 在被reduced之后的二维空间中, 不同类别的图像大致被分在了不同区域, 如右上角有一些都有着蓝天背景的图片, 左下角则是一些植物. See high-resolution version at <a href="http://cs.stanford.edu/people/karpathy/cnnembed/">http://cs.stanford.edu/people/karpathy/cnnembed/</a>.</p>
</blockquote>
<h2 id="visualizing-activations">Visualizing Activations</h2>
<h3 id="maximally-activating-patches">Maximally Activating Patches</h3>
<ul>
<li>
<p>Pick a layer and a channel, e.g. conv5 is 128*13*13, pick channel 17/128.</p>
</li>
<li>
<p>Run many images through the network, record values of chosen channel.</p>
</li>
<li>
<p>Visualize image patches taht correspond to maximal actiavtions.</p>
</li>
</ul>
<p>因为一个channel是由同一个卷积核生成的, 所以这一层上不管什么位置的高响应值都对应着在某张图片的某个位置出现了特定特征. 我们将所有在这一层的这一channel有着高响应值的图片提取出来, 然后截取出高响应值对应的reception field, 就得到了这些图片上出现特定特征的位置.</p>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%285%29.png" width="600px" /></p>
<blockquote>
<p>可以看到, 每个channel所寻找的特征不尽相同, 比如第一行就是在寻找类似一个"洞"的特征, 第二行则是在寻找一些弧形边缘.</p>
</blockquote>
<h3 id="occlusion-experiments">Occlusion Experiments</h3>
<p>Mask part of the image before feeding to CNN, draw hetmap of probability at each mask location.</p>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%286%29.png" width="600px" /></p>
<p>这一做法可以帮助我们了解到, 图像的那个部位对图像识别的结果影响最大, 红色区域是影响最大的, 黄色区域则影响较小.</p>
<h3 id="saliency-map">Saliency Map</h3>
<ul>
<li>How to tell which pixel matter for classification?</li>
<li>Compute gradient of (unnormalized) class score with respect to image pixels, take absolute value and max over RGB channels.</li>
</ul>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%287%29.png" width="600px" /></p>
<p>这样我们就可以看出图像的哪一部分对识别的贡献较大.</p>
<h3 id="imtermediate-features-via-guided-backprop">Imtermediate Features via (guided) backprop</h3>
<ul>
<li>Pick a single intermediate neruro, e.g. one value in 128*13*13 conv5 feature map.</li>
<li>
<p>Compute gradient of neuron value with respect to image pixels.</p>
</li>
<li>
<p>Images come out nicer if you only backprop positive gradients through each ReLU (guided backprop).</p>
</li>
</ul>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%288%29.png" width="600px" /></p>
<h2 id="visualizing-cnn-features-gradient-ascent">Visualizing CNN Features: Gradient Ascent</h2>
<p><strong>Guided Backprop:</strong> Find the part of an image that a neuron responds to.
<strong>Gradient Ascent:</strong> Generate a synthetic iamge that maximally activates a neuron.</p>
<div class="arithmatex">\[
I^* = argmax_I f(I) + R(I)
\]</div>
<p>where <span class="arithmatex">\(f(I)\)</span> is the neuron value, and <span class="arithmatex">\(R(I)\)</span> is the iamge regularizer.</p>
<ul>
<li>Initialize image to zeros.</li>
</ul>
<p>Repeat:</p>
<ul>
<li>Froward image to compute current scores.</li>
<li>Backprop to get gradient of neuron value with respect to image pixels.</li>
<li>Make a small update to the image.</li>
</ul>
<p>现在假如我们试图通过最大化某个类别的分数, 来生成该类别的一张图片:</p>
<div class="arithmatex">\[
argmax_I S_c(I) - \lambda||I||^2_2
\]</div>
<p>Simple Regularizer: Penalize L2 norm of generated image.</p>
<p>Better Regularizer: Penalize L2 norm of iamge; also during optimaization periodically:
1. Gaussian blur image
2. Clip pixels with small values to 0.
3. Clip pixels with small gradients to 0.</p>
<table>
<thead>
<tr>
<th><img alt="linear" class="center" src="../images/Lec12/1%20%289%29.png" width="600px" /></th>
<th><img alt="linear" class="center" src="../images/Lec12/1%20%2810%29.png" width="600px" /></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>可以看到生成的图片都较为合理的, 有些达到了不错的效果, 如flamingo, billiard table.</p>
</blockquote>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>We can use the same approach to visualize intermediate features:
<img alt="linear" class="center" src="../images/Lec12/1%20%2811%29.png" width="600px" /></p>
</div>
<details class="tip">
<summary>mutil-faceted</summary>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%2812%29.png" width="600px" /></p>
</details>
<h2 id="deep-dream-amplify-existing-features">Deep Dream: Amplify existing features</h2>
<table>
<thead>
<tr>
<th><img alt="linear" class="center" src="../images/Lec12/1%20%2813%29.png" width="650px" /></th>
<th><img alt="linear" class="center" src="../images/Lec12/1%20%2814%29.png" width="600px" /></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="feature-inversion">Feature Inversion</h2>
<p>Given a CNN feature vector for an image, find a new image that:</p>
<ul>
<li>Matches the given feature vector.</li>
<li>Looks natural.</li>
</ul>
<div class="arithmatex">\[
x^* = \mathop{\arg\min}_{x \in \mathbb{R}^{H \times W \times C}} L(\Phi(x), \Phi_0) + \lambda R(x)
\]</div>
<p>where
$$
L(\Phi(x), \Phi_0) = ||\Phi(x) - \Phi_0||^2
$$</p>
<p>$$
R(x) = \sum_{i, j}((x_{i, j+1}-x_{i, j})^2+(x_{i+1, j}-x_{i, j})^2)^{\frac{\beta}{2}}
$$
This regularizer is called Total Variation Regularizer, which encourages spatial smmothness.</p>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%2815%29.png" width="600px" /></p>
<blockquote>
<p>可以看到, 使用越低维的特征, 生成的图片与原图越吻合, 这说明了高维特征信息会丢弃掉一些不那么重要的信息, 只保留图像一些比较显著的特征.</p>
</blockquote>
<h2 id="texture-synthesis">Texture synthesis</h2>
<p>Given a simple patch of some texture can we generate a bigger image of the same texture.</p>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%2816%29.png" width="300px" /></p>
<table>
<thead>
<tr>
<th><img alt="linear" class="center" src="../images/Lec12/1%20%2817%29.png" width="600px" /></th>
<th><img alt="linear" class="center" src="../images/Lec12/1%20%2818%29.png" width="600px" /></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="neural-style-transfer">Neural Style Transfer</h2>
<p><img alt="linear" class="center" src="../images/Lec12/1%20%2819%29.png" width="600px" /></p>
<p>We combine feature reconstruction and texture synthesis together to do the neural style transfer.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://github.com/AutonomierLong"  target="_blank" rel="noopener">Autonomier Long</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/AutonomierLong" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/TheJamesWillett" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/willettjames/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>